user  qa;
worker_processes  4;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;
    #
    client_max_body_size 100m;
    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;

    server {
        listen       80;
        server_name  localhost;

        #charset koi8-r;
           error_page   405 =200 @405;
           location @405
           {
              root  /opt/htdocs;
            }    
        #access_log  logs/host.access.log  main;

        root  /data0/qa/tiger_api_vue;
        index  index.html index.htm;
        location / {
        try_files $uri $uri/ @router;
        index index.html;
        }

        location @router {
          rewrite ^.*$ /index.html last;
        }

     location /tigerfintech {
        #    fastcgi_buffers 256 128k;
         #   chunked_transfer_encoding off;
            rewrite  ^.+tigerfintech/?(.*)$ /$1 break;
            include  uwsgi_params;
            uwsgi_param UWSGI_SCRIPT tiger_api.wsgi;
            uwsgi_param UWSGI_CHDIR /data0/qa/tiger_api;
            uwsgi_pass  127.0.0.1:8080;             
       }
     location /service {
         #   rewrite  ^.+api/?(.*)$ /$1 break;
            #fastcgi_buffers 256 128k;
            #chunked_transfer_encoding off;
            include  uwsgi_params;
            uwsgi_param UWSGI_SCRIPT tiger_api.wsgi;
            uwsgi_param UWSGI_CHDIR /data0/qa/tiger_api;
            uwsgi_pass  127.0.0.1:8080;             
}
    location /preview {
           root   /data0/qa/tiger_api_vue;
           index  test.html test.ht; 
                   }
 
    }


    # another virtual host using mix of IP-, name-, and port-based configuration
    #
    server {
        listen       8088;
         server_name  localhost;

        #charset koi8-r;
           error_page   405 =200 @405;
           location @405
           {
              root  /opt/htdocs;
            }    
        #access_log  logs/host.access.log  main;

        root  /data0/qa/tiger_testcase;
        index  index.html index.htm;
        location / {
        try_files $uri $uri/ @router;
        index index.html;
        }

        location @router {
          rewrite ^.*$ /index.html last;
        }
             location /tigerfintech {
            rewrite  ^.+tigerfintech/?(.*)$ /$1 break;
            include  uwsgi_params;
            uwsgi_param UWSGI_SCRIPT tiger_api.wsgi;
            uwsgi_param UWSGI_CHDIR /data0/qa/tiger_api;
            uwsgi_pass  127.0.0.1:8080;             
       }
     location /service {
         #   rewrite  ^.+api/?(.*)$ /$1 break;
            include  uwsgi_params;
            uwsgi_param UWSGI_SCRIPT tiger_api.wsgi;
            uwsgi_param UWSGI_CHDIR /data0/qa/tiger_api;
            uwsgi_pass  127.0.0.1:8080;             
}
    location /preview {
           root   /data0/qa/tiger_api_vue;
           index  test.html test.ht; 
                   }
    }



}
